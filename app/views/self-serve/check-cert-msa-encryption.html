{% extends "layout.html" %}

{% block page_title %}
  GOV.UK prototype kit
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="navigation-service">
      <div class="navigation-service-name">
        {{ teamName }}
      </div>
    </div>
  </div>
</div>

<div class="govuk-grid-row">

  <div class="govuk-grid-column-one-third">

    <div class="side-navigation">
      <ul class="govuk-list">
        <li class="active">
          <a href="dashboard">Manage certificates</a>
        </li>
        <li class="">
          <a href="team-members">Team members</a>
        </li>
      </ul>
    </div>

  </div>

  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l">
      Check you've uploaded the right certificate
    </h1>

    <p>
      The certificate you've uploaded contains the following information:
    </p>

    <dl class="govuk-summary-list">

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Used by
        </dt>
        <dd class="govuk-summary-list__value">
          {{ serviceName }}
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Environment
        </dt>
        <dd class="govuk-summary-list__value">
          Production
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Valid from
        </dt>
        <dd class="govuk-summary-list__value">
          {{ todaysDate }}, 11:59pm
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Valid until
        </dt>
        <dd class="govuk-summary-list__value">
          {{ aYearFromNow }}, 11:59pm
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          Common name
        </dt>
        <dd class="govuk-summary-list__value">
          MSA-encryption-cert-4
        </dd>
      </div>

    </dl>

    <details class="govuk-details">
      <summary class="govuk-details__summary">
        <span class="govuk-details__summary-text">
          View full certificate
        </span>
      </summary>
      <div class="govuk-details__code"><pre><code>
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            57:s5:f8:c9:97:ef:c9:aa:c3:a5:b7:1d:eb:d3:e3:96
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: C=GB, O=Cabinet Office, OU=GDS, CN=IDAP Relying Party Test CA
        Validity
            Not Before: {{ startDate }} 00:00:00 2019 GMT
            Not After : {{ endDate }} 23:59:59 2020 GMT
        Subject: C=GB, ST=England, L=London, O={{ departmentName }}, OU={{ serviceName }}, CN=www-stage.{{ serviceSlug }}.service.gov.uk MSA-encryption-cert-3
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:ae:43:c6:5f:06:87:c1:ac:21:0f:89:b8:21:2f:
                    52:8d:76:94:da:41:3a:27:49:7b:72:b3:2f:25:5f:
                    2a:aa:57:92:68:9f:fc:4d:5f:7d:84:89:17:12:75:
                    46:e6:ea:ea:51:15:65:1d:d1:c2:f1:c9:56:a1:52:
                    86:64:4b:d0:39:05:98:76:9f:f6:bb:1d:3a:95:ff:
                    30:f7:bd:0c:ba:f4:31:cc:ef:3d:8b:3f:99:ef:8a:
                    dd:4c:f6:c5:0c:70:28:aa:f8:fd:9a:4e:e1:3a:f8:
                    10:14:b6:44:00:6f:a4:d0:b3:cc:2f:17:21:b0:73:
                    cc:c3:02:a4:b7:a5:7a:80:e1:90:6b:8a:5c:4c:a1:
                    41:39:47:4c:7c:1c:a5:d7:29:67:23:96:ef:47:67:
                    70:03:f3:1f:0c:ec:a1:ec:4f:b9:80:43:80:44:61:
                    7e:bc:e0:e9:8c:1b:0f:82:69:b7:4f:af:f9:ad:36:
                    98:07:98:56:77:7b:88:da:84:3e:c7:46:b4:9a:d5:
                    e2:32:8f:93:fd:b9:ad:b7:6a:52:b5:2f:d6:53:1e:
                    42:e4:9f:67:31:c7:a5:3c:1b:59:e2:4c:ac:de:ab:
                    b0:0e:4f:2c:7d:47:d3:83:75:3a:02:f6:4c:90:ec:
                    48:da:de:cb:eb:24:94:0a:e7:20:9c:bf:65:5e:81:
                    7e:13
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 CRL Distribution Points:

                Full Name:
                  URI:http://onsitecrl.trustwise.com/CabinetOfficeIDAPRelyingPartyTestCA/LatestCRL.crl

            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Subject Key Identifier:
                64:E4:57:74:34:FB:A4:7E:7A:FD:67:99:23:BD:3B:23:05:4E:67:66
            X509v3 Authority Key Identifier:
                keyid:DD:E4:F5:5D:1A:0A:0F:3A:D1:48:22:1E:4E:C0:F8:6E:36:F6:C5:25

            Authority Information Access:
                OCSP - URI:http://std-ocsp.trustwise.com

    Signature Algorithm: sha256WithRSAEncryption
         0e:5f:df:47:ec:42:01:56:bf:78:c1:64:d0:28:c9:ef:51:9b:
         e7:28:78:23:ae:85:8a:38:9f:b6:89:77:b6:5f:01:65:b5:e8:
         d3:b7:ab:fb:28:f7:c7:f2:2d:51:98:b6:f6:7a:4b:7f:9e:43:
         e4:69:76:d1:fa:98:57:fc:b6:4f:6b:75:5e:a0:a0:b5:f7:e7:
         07:83:83:b8:f0:87:1a:05:2c:5d:19:ff:7e:ac:18:8c:8d:9f:
         54:8f:b7:af:6c:31:db:fa:8e:50:b7:df:f1:15:8e:82:9b:3b:
         f7:7a:63:90:0b:0d:73:9c:7c:5c:91:95:19:96:bc:0b:12:59:
         20:8c:1f:24:c0:ac:81:ba:5a:8d:33:e4:15:c8:22:af:5e:db:
         5c:2f:e8:37:df:be:20:9b:ba:2f:7f:ef:2a:bb:9e:ef:b3:77:
         1a:8e:fd:ee:6a:6f:2c:88:64:fb:ed:49:e5:b0:bc:19:c1:e1:
         be:55:e3:a9:71:24:4c:40:b4:bd:35:60:f5:2c:cf:d7:51:ca:
         0b:06:11:22:35:08:2e:d3:49:25:3e:d8:e3:ed:25:47:95:fb:
         66:e8:82:77:bd:9f:0e:bf:56:d5:2c:f7:62:46:7e:0f:93:65:
         0b:7a:76:47:97:0b:4c:c9:f2:85:eb:1e:2b:14:2e:ca:5c:5f:
         d2:17:23:3a
-----BEGIN CERTIFICATE-----
MIIErDCCA5SgAwIBAgIQV+X42ZfvyerDpbcd68PjljANBgkqhkiG9w0BAQsFADBZ
MQswCQYDVQQGEwJHQjEXMBUGA1UEChMOQ2FiaW5ldCBPZmZpY2UxDDAKBgNVBAsT
A0dEUzEjMCEGA1UEAxMaSURBUCBSZWx5a666IFBhcnR5IFRlc3QgQ0EwHhcNMTkw
MjE0MDAwMDAwWhcNMjAwMjE0MjM1OTU5WjCByDELMAkGA1UEBhMCR0IxEDAOBgNV
BAgTB0VuZ2xhbmQxDzANBgNVBAcTBkxvbmRvbjEtMCsGA1UEChQkVGhlIERlcGFy
dG1lbnQgZm9yIFdvcmsgYW5kIFBlbnNpb25zMSYwJAYDVQQLFB1Vbml2ZXJzYWwg
Q3JlZGl0IEZ1bGwgU2VydmljZTE/MD0GA1UEAxM2d3d3LXN0YWdlLnVuaXZlcnNh
bC1jcmVkaXQuc2VydmljZS5nb3YudWsgU1AgU2lnbmluZyA1MIIBIjANBgkqhkiG
9w0BAQEFAAOCAQ8AMIIBCGGGdQEArkPGXwaHwawhD4m4IS9SjXaU2kE6J0l7crMv
JV8qqleSaJ/8TV99hIkXEnVG5urqURVlHdHC8clWoVKGZEvQOQWYdp/2ux06lf8w
970MuvQxzO89iz+Z74rdTPbFDHAoqvj9mk7hOvgQFLZEAG+k0LPMLxchsHPMwwKk
t6V6gOGQa4pcTKFBOUdMfByl1ylnI5bvR2dwA/MfDOyh7E+5gEOARGF+vODpjBsP
gmm3T6/5rTaYB5hWd3uI2oQ+x0a0mtXiMo+T/bmtt2pStS/WUx5C5J9nMcelPBtZ
4kys3quwDk8sfUfTg3U6AvZMkOxI2t7L6ySUCucgnL9lXoF+EwIDAQABo4H/MIH8
MAwGA1UdEwEB/wQCMAAwYQYDVR0fBFowWDBWoFSgUoZQaHR0cDovL29uc2l0ZWNy
bC50cnVzdHdpc2UuY29tL0NhYmluZXRPZmZpY2VJREFQUmVseWluZ1BhcnR5VGVz
dENBL0xhdGVzdENSTC5jcmwwDgYDVR0PAQH/BAQDAgeAMB0GA1UdDgQWBBRk5Fd0
NPukfnr9Z5kjvTsjBU5nZjAfBgNVHSMEGDAWgBTd5PVdGgoPOtFIIh5OwPhuNvbF
JTA5BggrBgEFBQcBAQQtMCswKQYIKwYBBQUHMAGGHWh0dHA6Ly9zdGQtb2NzcC50
cnVzdHdpc2UuY29tMA0GCSqGSIb3DQEBCwUAA4IBAQAOX99H7EIBVr94wWTQKMnv
UZvnKHgjroWKOJ+2iXe2XwFltejTt6v7KPfH8i1RmLb2ekt/nkPkaXbR+phX/LZP
a3VeoKC19+cHg4O48IcaBSxdGf9+rBiMjZ9Uj7evbDHb+o5Qt9/xFY6Cmzv3emOQ
Cw1znHxckZUZlrwLElkgjB8kwKyBulqNM+QVyCKvXttcL+g3374gm7ovf+8qu57v
s3cajv3uam8siGT77UnlsLwZweG+VeOpcSRMQLS9NWD1LM/XUcoLBhEiNQgu00kl
Ptjj7SVHlftm6IJ3vZ8Ov1bVLPdiRn4Pk2ULenZHlwtMyfKF6x4rFC7KXF/SFyM6
-----END CERTIFICATE-----

</code></pre></div>
    </details>

    <p>
      If you have already deployed your encryption key, using this certificate will update our infrastructure immediately with no disruption to your service.
    </p>

    {% from "button/macro.njk" import govukButton %}

    <form action="confirmation-msa-encryption">

      <!-- hidden form to change status on dashboard page -->
      {{ govukInput({
        id: "confirm-cert-msa-encryption",
        name: "confirm-cert-msa-encryption",
        value: "true",
        classes: "govuk-visually-hidden"
      }) }}

      {{ govukButton({
        text: "Use this certificate",
        classes: "govuk-!-margin-bottom-5"
      }) }}

    </form>

    <p>
      <a href="upload-cert-msa-encryption">
        Upload a different certificate
      </a>
    </p>

  </div>
</div>

{% endblock %}
